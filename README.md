# Silero TTS Converter

Скрипт для преобразования текста в речь с поддержкой русского(преимущественно) и английского языков, использующий модели Silero TTS.
Конвертирует текстовые файлы из формата .txt в формат .wav

## Особенности

- **Мультиязычность**: Автоматическое определение и обработка русского и английского текста
- **Параллельная обработка**: Многопоточное преобразование текста для повышения производительности
- **Умная предобработка текста**:
  - Конвертация чисел в текстовое представление
  - Обработка дат и времени
  - Обработка аббревиатур (с фонетическим произношением английских букв)
  - Замена специальных символов
  - Улучшение произношения сложных слов
  - Обработка URL и email адресов
  - Добавление естественных пауз

- **Подробная статистика**:
  - Время выполнения каждого этапа 
  - Размер исходного текста
  - Длительность получившегося аудио
  - Информация о параллельной обработке

## Использование

### Базовое использование

```bash
python tts.py
```
По умолчанию скрипт будет искать файл `text.txt` в текущей директории.

### Указание входного файла

```bash
python tts.py --input my_text.txt
# или
python tts.py -i my_text.txt
```

### Тестирование английских голосов

```bash
python tts.py --input my_text.txt --test_eng
```
Создаст отдельные аудиофайлы для каждого английского голоса (en_0 до en_117).

### Отладка разделения текста

```bash
python tts.py --input my_text.txt --dump_chunks
```
Сохранит все фрагменты текста в файл `my_text_chunks.txt` для отладки.

### Формат входного файла

- Файл должен быть в формате `.txt`
- Кодировка файла: UTF-8
- Может содержать смешанный русский и английский текст
- Поддерживаются числа, даты, время, URL, email

### Пример входного текста

```text
Привет! Это текст на русском языке.
This is English text.
Смешанный текст: check your email at test@example.com.
Сегодня 01.01.2024 в 15:30 температура 22.5 градуса.
Аббревиатуры: IBM SQL CSS работают как "eye bee em", "es queue el", "see es es".
```

## Особенности реализации

1. **Определение языка**:
   - Анализ текста на уровне предложений
   - Разделение смешанного текста на языковые фрагменты
   - Сохранение порядка частей при синтезе

2. **Параллельная обработка**:
   - Автоматическое определение оптимального числа потоков
   - Независимая обработка каждого фрагмента
   - Сохранение порядка частей при объединении

3. **Обработка текста**:
   - Нормализация пунктуации и пробелов
   - Конвертация чисел в текстовое представление
   - Обработка специальных случаев (даты, время, URL)
   - Фонетическое произношение английских аббревиатур
   - Добавление пауз для естественного звучания

4. **Обработка ошибок**:
   - Проверка формата входного файла
   - Валидация текста
   - Продолжение работы при ошибках в отдельных фрагментах

## Выходные данные

- Аудиофайл в формате WAV (48kHz)
- Имя выходного файла соответствует имени входного с расширением .wav
- При тестировании голосов создаются файлы вида `input_en_X.wav`
- При отладке создается файл `input_chunks.txt` с фрагментами текста
- Подробная статистика о процессе конвертации

## Пример вывода

```
Загрузка русской модели...
Загрузка английской модели...
Время загрузки моделей: 5.2 сек.

Чтение текста из файла text.txt...
Размер текста: 1,234 символов
Количество частей для обработки: 8
Используется потоков: 4

Часть 1 из 8 обработана за 1.5 сек.
Часть 2 из 8 обработана за 1.3 сек.
...

Статистика:
Размер исходного текста: 1,234 символов
Длительность аудио: 1 мин. 30.5 сек.
Общее время выполнения: 18.1 сек.
  - Загрузка моделей: 5.2 сек.
  - Обработка текста: 12.4 сек.
  - Накладные расходы: 0.5 сек.
```

## Ограничения

- Максимальная длина одного фрагмента текста: 900 символов
- Поддерживаются только русский и английский языки
- Требуется подключение к интернету для первой загрузки моделей

## Производительность

- Скорость обработки зависит от длины текста и доступных CPU
- Параллельная обработка эффективна для текстов с большим количеством фрагментов
- Основное время тратится на синтез речи, а не на предобработку текста 